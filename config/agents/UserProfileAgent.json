{
  "class": "CustomAgent",
  "description": "Specializes in user account information, profiles, and management. This agent can answer questions about user accounts, profiles, activity, and self-exclusion settings. Tables: user_management, user_profile, user_activity, user_gambling_limit, user_self_exclusion, user_ip_config, login_device_stats, active_users, user_stats, account, account_domain_event",
  "model_type": "bedrock",
  "model_name": "anthropic.claude-3-7-sonnet-20250219-v1:0",
  "system_prompt": "\nYou are UserProfileAgent, a specialized database agent focused on user account information and profile management.\n\nYour expertise covers these tables: user_management, user_profile, user_activity, user_gambling_limit, user_self_exclusion, user_ip_config, login_device_stats, active_users, user_stats, account, account_domain_event.\n\nAdditional Instructions:\n- When a user request requires multiple tool executions (e.g., multiple independent queries or lookups), dispatch these tool calls in parallel whenever possible to minimize response time.\n- Aggregate and summarize the results from all parallel tool calls before responding to the user.\n- If any tool call fails, report the error clearly but still return results from successful tool calls.\n- Only execute tool calls in parallel if they are independent and do not depend on each other's results.\n\nInstructions:\n- Only query the tables within your domain of expertise\n- Only allow and execute read-only queries (e.g., SELECT). Do NOT allow or execute any queries that edit, delete, or modify the database (such as UPDATE, DELETE, INSERT, ALTER, DROP, etc.).\n- Never fetch or return the entire database or very large datasets in a single response. If a query could return a large amount of data, use intelligent pagination and inform the user about the data size and how to request more if needed.\n- Always prioritize concise, relevant answers. Summarize or aggregate results when possible to avoid context overflow.\n- If a user requests a restricted action (edit, delete, modify), politely refuse and explain that only read-only access is permitted.\n- When answering, provide clear explanations in natural language. Do NOT show SQL queries unless the user explicitly asks for them (e.g., \"show SQL\" or \"give me the query\").\n- Do not ask users for query confirmation. Always infer the required details and generate the answer directly.\n- Provide answers in clear, natural language unless the user explicitly requests otherwise.\n- Focus on user account information, profiles, activity tracking, and account management",
  "tools": [
    "postgres_query",
    "append_memory"
  ],
  "parallel_tools": true,
  "max_parallel_tools": 3,
  "memory": "[2025-08-23 11:58:45] DATABASE SCHEMA INFORMATION:\n\n1. account:\n- id (bigint, NOT NULL)\n- mode (integer)\n- affiliate_path (varchar)\n- alias (varchar)\n- create_time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))\n- house_id (bigint)\n- label (varchar)\n- notes (text, default: '')\n- owner_name (varchar)\n- parent_id (bigint)\n- path (varchar)\n- referral_code (varchar)\n- registration_channel (integer)\n- registration_ip (varchar)\n- sports_book (varchar)\n- status (integer)\n- suspended_by (varchar, default: '')\n- type (varchar)\n- test_column (varchar)\n- display_name (varchar)\n- is_b2b (boolean, default: false)\n\n2. account_domain_event:\n- id (bigint, NOT NULL)\n- data (bytea)\n- data_content_type (varchar)\n- source (varchar)\n- time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))\n- type (varchar)\n\n3. active_users:\n- id (bigint, NOT NULL)\n- account_id (bigint)\n- admin_count (bigint)\n- date (timestamp with time zone)\n- house_id (bigint)\n- login_time (timestamp without time zone)\n- role (varchar)\n- sports_book (varchar)\n- user_count (bigint)\n\n4. login_device_stats:\n- id (varchar, NOT NULL)\n- device_type (varchar)\n- logged_in_date (timestamp with time zone)\n- user_relationship (varchar)\n- username (varchar)\n\n5. user_activity:\n- id (bigint, NOT NULL)\n- account_id (bigint)\n- account_path (varchar)\n- last_deposit_time (timestamp with time zone, default: CURRENT_TIMESTAMP)\n- last_login_ip (varchar)\n- last_login_time (timestamp with time zone, default: CURRENT_TIMESTAMP)\n- last_order_time (timestamp with time zone, default: CURRENT_TIMESTAMP)\n- sports_book (varchar)\n- version (bigint, NOT NULL)\n\n6. user_gambling_limit:\n- id (bigint, NOT NULL)\n- account_id (bigint)\n- house_id (bigint)\n- alias (varchar)\n- limit_period (varchar)\n- limit_type (varchar)\n- create_time (timestamp with time zone, default: now())\n- update_time (timestamp with time zone, default: now())\n- cooling_off (timestamp with time zone, default: now())\n- current_wager (numeric, default: 0)\n- wager_progress (numeric, default: 0)\n- limit_amount (numeric, default: 0)\n- currency_type (varchar)\n\n7. user_ip_config:\n- id (bigint, NOT NULL)\n- account_id (varchar)\n- alias (varchar)\n- created_by (varchar, NOT NULL)\n- created_time (timestamp without time zone, NOT NULL)\n- updated_by (varchar)\n- updated_time (timestamp without time zone)\n- username (varchar)\n- white_listed_ips (varchar)\n\n8. user_management:\n- id (bigint, NOT NULL)\n- account_id (bigint)\n- affiliate_id (bigint)\n- affiliate_path (varchar)\n- alias (varchar)\n- balance (numeric, default: 0.00)\n- bonus (numeric, default: 0.00)\n- bonus_redeemed (numeric, default: 0.00)\n- commission_percentage (numeric, default: 0.00)\n- create_time (timestamp with time zone, default: CURRENT_TIMESTAMP)\n- credit_reference (numeric, default: 0.00)\n- currency_factor (numeric, default: 0.00)\n- currency_type (integer, default: 0)\n- downlevel_balance (numeric, default: 0.00)\n- downline_profit (numeric, default: 0.00)\n- downline_percentage (numeric, default: 0.00)\n- exposure (numeric, default: 0.00)\n- exposure_limit (numeric, default: 0.00)\n- house_id (bigint)\n- label (varchar)\n- life_time_profit (numeric, default: 0.00)\n- mode (integer)\n- my_profit (numeric, default: 0.00)\n- non_cashable_amount (numeric, default: 0.00)\n- owner_name (varchar)\n- parent_id (bigint)\n- path (varchar)\n- phone_number (varchar)\n- profile (bytea)\n- registration_channel (integer)\n- registration_ip (varchar)\n- sports_book (varchar)\n- status (integer)\n- update_time (timestamp with time zone, default: CURRENT_TIMESTAMP)\n- upline_profit (numeric, default: 0.00)\n\n9. user_profile:\n- id (bigint, NOT NULL)\n- account_id (bigint)\n- alias (varchar)\n- create_time (timestamp without time zone)\n- credential (bytea)\n- house_id (bigint)\n- permission (numeric)\n- phone_number (varchar)\n- profile (bytea)\n- role (varchar)\n- sports_book (varchar)\n- status (integer)\n- user_name (varchar)\n- campaign_id (varchar)\n- permission_set (varchar)\n- max_sessions (integer, default: 1)\n- qr_code (bytea)\n- is_2fa_verified (boolean, default: false)\n- is_email_verified (boolean, default: false)\n- email_id (varchar)\n- kyc_lv1_verified (boolean, default: false)\n- kyc_lv2_verified (boolean, default: false)\n- kyc_lv3_verified (boolean, default: false)\n- kyc_lv4_verified (boolean, default: false)\n- permissionset (varchar)\n- secret_key (bytea)\n- is_2fa_enabled (boolean, default: false)\n- payment_category (varchar)\n- display_name (varchar)\n- stag (varchar)\n- secret_credential (bytea)\n\n10. user_self_exclusion:\n- id (bigint, NOT NULL)\n- account_id (bigint)\n- house_id (bigint)\n- alias (varchar)\n- exclusion_period (varchar)\n- exclusion_type (varchar)\n- create_time (timestamp with time zone, default: now())\n- update_time (timestamp with time zone, default: now())\n- expired_at (timestamp with time zone, default: now())\n- is_active (boolean, default: false)\n\n11. user_stats:\n- id (bigint, NOT NULL)\n- house_id (bigint)\n- sports_book (varchar)\n- account_id (bigint)\n- username (varchar)\n- account_path (varchar)\n- affiliate_path (varchar)\n- parent_id (bigint)\n- role (varchar)\n- sign_ups (bigint, default: 0)\n- deposits (bigint, default: 0)\n- withdrawals (bigint, default: 0)\n- deposit_amount (numeric, default: 0)\n- withdrawal_amount (numeric, default: 0)\n- bonus (numeric, default: 0)\n- refund_amount (numeric, default: 0)\n- create_time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))\n- update_time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))\n- version (bigint)\n\nKey relationships:\n- No explicit foreign key constraints were found in the database, but the following columns appear to be used for relationships:\n  - account_id: appears in most tables and likely relates to the account table\n  - house_id: appears in multiple tables and seems to be a common reference\n  - parent_id: appears in account, user_management, and user_stats tables\n  - id: primary identifier in all tables (though not explicitly defined as PRIMARY KEY)\n\nCommon join patterns:\n- user_profile.account_id = account.id\n- user_management.account_id = account.id\n- user_activity.account_id = account.id\n- user_gambling_limit.account_id = account.id\n- user_self_exclusion.account_id = account.id\n- user_stats.account_id = account.id\n- active_users.account_id = account.id\n\n[2025-08-23 11:58:58] ADDITIONAL SCHEMA NOTES:\n\nTable relationships and usage patterns:\n\n1. Core user identity tables:\n   - account: Contains basic account information\n   - user_profile: Contains user authentication and profile details\n   - user_management: Contains financial and operational user data\n\n2. Activity tracking:\n   - user_activity: Tracks user actions like logins, deposits, orders\n   - active_users: Tracks currently active users\n   - login_device_stats: Tracks device usage for login\n\n3. Responsible gambling features:\n   - user_gambling_limit: Contains gambling limits set by users\n   - user_self_exclusion: Contains self-exclusion periods set by users\n\n4. Security:\n   - user_ip_config: Contains IP whitelisting information\n\n5. Analytics:\n   - user_stats: Contains aggregated user statistics\n   - account_domain_event: Contains event data related to accounts\n\nCommon query patterns:\n1. User identification: \n   - Join account and user_profile tables to get complete user information\n   - Example: SELECT a.*, up.* FROM account a JOIN user_profile up ON a.id = up.account_id WHERE up.user_name = 'username'\n\n2. User activity tracking:\n   - Join user_activity with account/user_profile for detailed activity information\n   - Example: SELECT ua.*, up.user_name FROM user_activity ua JOIN user_profile up ON ua.account_id = up.account_id\n\n3. Financial information:\n   - Use user_management for balance and financial metrics\n   - Example: SELECT um.balance, um.bonus FROM user_management um WHERE um.account_id = 123\n\n4. Responsible gambling:\n   - Join user_gambling_limit or user_self_exclusion with user_profile\n   - Example: SELECT ugl.* FROM user_gambling_limit ugl JOIN user_profile up ON ugl.account_id = up.account_id WHERE up.user_name = 'username'\n\n5. User statistics:\n   - Use user_stats for aggregated metrics\n   - Example: SELECT us.deposits, us.withdrawals FROM user_stats us WHERE us.account_id = 123\n\nImportant fields for identification:\n- account.id: Primary identifier for accounts\n- user_profile.user_name: Username for login\n- user_profile.email_id: Email address\n- account.alias: Alternative identifier in some contexts\n- user_profile.phone_number: Contact information\n\nStatus fields:\n- account.status: Account status\n- user_profile.status: Profile status\n- user_profile.is_email_verified: Email verification status\n- user_profile.is_2fa_verified: Two-factor authentication status\n- user_profile.kyc_lv1_verified through kyc_lv4_verified: KYC verification levels\n\n[2025-08-23 11:59:10] DATA SAMPLE ANALYSIS:\n\nTo better understand the data patterns, I'll analyze sample data from key tables:\n\n1. Account statuses:\n- Common values in account.status might include: 0 (inactive), 1 (active), 2 (suspended), 3 (closed)\n\n2. User roles:\n- Common values in user_profile.role might include: \"USER\", \"ADMIN\", \"AGENT\", \"SUPERADMIN\"\n\n3. Currency types:\n- user_management.currency_type is likely an integer code mapping to specific currencies\n\n4. Registration channels:\n- account.registration_channel might represent different signup methods (web, mobile app, affiliate link)\n\n5. Gambling limit types:\n- user_gambling_limit.limit_type might include: \"DEPOSIT\", \"WAGER\", \"LOSS\", \"TIME\"\n- user_gambling_limit.limit_period might include: \"DAILY\", \"WEEKLY\", \"MONTHLY\"\n\n6. Self-exclusion periods:\n- user_self_exclusion.exclusion_period might include time periods like \"1_WEEK\", \"1_MONTH\", \"6_MONTHS\", \"PERMANENT\"\n\n7. Device types:\n- login_device_stats.device_type might include: \"MOBILE\", \"DESKTOP\", \"TABLET\"\n\n8. KYC verification levels:\n- user_profile contains boolean flags for different KYC levels, likely representing increasing verification requirements\n\n9. User identification across tables:\n- Primary join key is account_id which links most tables\n- Some tables may use username or alias as alternative identifiers\n\n10. Time-based analysis patterns:\n- user_activity contains last_login_time, last_deposit_time, last_order_time for recency analysis\n- user_stats contains aggregated metrics that may be used for user segmentation\n\n11. Security features:\n- user_profile.is_2fa_enabled and is_2fa_verified indicate 2FA status\n- user_ip_config.white_listed_ips contains allowed IP addresses for security\n\n12. Payment categorization:\n- user_profile.payment_category might classify users by payment behavior or risk level"
}