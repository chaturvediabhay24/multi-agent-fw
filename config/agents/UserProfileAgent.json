{
  "class": "CustomAgent",
  "description": "Specializes in user account information, profiles, and management. This agent can answer questions about user accounts, profiles, activity, and self-exclusion settings. Tables: user_management, user_profile, user_activity, user_gambling_limit, user_self_exclusion, user_ip_config, login_device_stats, active_users, user_stats, account, account_domain_event",
  "model_type": "bedrock",
  "model_name": "anthropic.claude-3-7-sonnet-20250219-v1:0",
  "system_prompt": [
    "",
    "You are UserProfileAgent, a specialized database agent focused on user account information and profile management.",
    "",
    "Your expertise covers these tables: user_management, user_profile, user_activity, user_gambling_limit, user_self_exclusion, user_ip_config, login_device_stats, active_users, user_stats, account, account_domain_event.",
    "",
    "Additional Instructions:",
    "- When a user request requires multiple tool executions (e.g., multiple independent queries or lookups), dispatch these tool calls in parallel whenever possible to minimize response time.",
    "- Aggregate and summarize the results from all parallel tool calls before responding to the user.",
    "- If any tool call fails, report the error clearly but still return results from successful tool calls.",
    "- Only execute tool calls in parallel if they are independent and do not depend on each other's results.",
    "",
    "Instructions:",
    "- Only query the tables within your domain of expertise",
    "- Only allow and execute read-only queries (e.g., SELECT). Do NOT allow or execute any queries that edit, delete, or modify the database (such as UPDATE, DELETE, INSERT, ALTER, DROP, etc.).",
    "- Never fetch or return the entire database or very large datasets in a single response. If a query could return a large amount of data, use intelligent pagination and inform the user about the data size and how to request more if needed.",
    "- Always prioritize concise, relevant answers. Summarize or aggregate results when possible to avoid context overflow.",
    "- If a user requests a restricted action (edit, delete, modify), politely refuse and explain that only read-only access is permitted.",
    "- When answering, provide clear explanations in natural language. Do NOT show SQL queries unless the user explicitly asks for them (e.g., \"show SQL\" or \"give me the query\").",
    "- Do not ask users for query confirmation. Always infer the required details and generate the answer directly.",
    "- Provide answers in clear, natural language unless the user explicitly requests otherwise.",
    "- Focus on user account information, profiles, activity tracking, and account management"
  ],
  "tools": [
    "postgres_query",
    "append_memory"
  ],
  "parallel_tools": true,
  "max_parallel_tools": 3,
  "memory": [
    "[2025-08-23 11:58:45] DATABASE SCHEMA INFORMATION:",
    "",
    "1. account:",
    "- id (bigint, NOT NULL)",
    "- mode (integer)",
    "- affiliate_path (varchar)",
    "- alias (varchar)",
    "- create_time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))",
    "- house_id (bigint)",
    "- label (varchar)",
    "- notes (text, default: '')",
    "- owner_name (varchar)",
    "- parent_id (bigint)",
    "- path (varchar)",
    "- referral_code (varchar)",
    "- registration_channel (integer)",
    "- registration_ip (varchar)",
    "- sports_book (varchar)",
    "- status (integer)",
    "- suspended_by (varchar, default: '')",
    "- type (varchar)",
    "- test_column (varchar)",
    "- display_name (varchar)",
    "- is_b2b (boolean, default: false)",
    "",
    "2. account_domain_event:",
    "- id (bigint, NOT NULL)",
    "- data (bytea)",
    "- data_content_type (varchar)",
    "- source (varchar)",
    "- time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))",
    "- type (varchar)",
    "",
    "3. active_users:",
    "- id (bigint, NOT NULL)",
    "- account_id (bigint)",
    "- admin_count (bigint)",
    "- date (timestamp with time zone)",
    "- house_id (bigint)",
    "- login_time (timestamp without time zone)",
    "- role (varchar)",
    "- sports_book (varchar)",
    "- user_count (bigint)",
    "",
    "4. login_device_stats:",
    "- id (varchar, NOT NULL)",
    "- device_type (varchar)",
    "- logged_in_date (timestamp with time zone)",
    "- user_relationship (varchar)",
    "- username (varchar)",
    "",
    "5. user_activity:",
    "- id (bigint, NOT NULL)",
    "- account_id (bigint)",
    "- account_path (varchar)",
    "- last_deposit_time (timestamp with time zone, default: CURRENT_TIMESTAMP)",
    "- last_login_ip (varchar)",
    "- last_login_time (timestamp with time zone, default: CURRENT_TIMESTAMP)",
    "- last_order_time (timestamp with time zone, default: CURRENT_TIMESTAMP)",
    "- sports_book (varchar)",
    "- version (bigint, NOT NULL)",
    "",
    "6. user_gambling_limit:",
    "- id (bigint, NOT NULL)",
    "- account_id (bigint)",
    "- house_id (bigint)",
    "- alias (varchar)",
    "- limit_period (varchar)",
    "- limit_type (varchar)",
    "- create_time (timestamp with time zone, default: now())",
    "- update_time (timestamp with time zone, default: now())",
    "- cooling_off (timestamp with time zone, default: now())",
    "- current_wager (numeric, default: 0)",
    "- wager_progress (numeric, default: 0)",
    "- limit_amount (numeric, default: 0)",
    "- currency_type (varchar)",
    "",
    "7. user_ip_config:",
    "- id (bigint, NOT NULL)",
    "- account_id (varchar)",
    "- alias (varchar)",
    "- created_by (varchar, NOT NULL)",
    "- created_time (timestamp without time zone, NOT NULL)",
    "- updated_by (varchar)",
    "- updated_time (timestamp without time zone)",
    "- username (varchar)",
    "- white_listed_ips (varchar)",
    "",
    "8. user_management:",
    "- id (bigint, NOT NULL)",
    "- account_id (bigint)",
    "- affiliate_id (bigint)",
    "- affiliate_path (varchar)",
    "- alias (varchar)",
    "- balance (numeric, default: 0.00)",
    "- bonus (numeric, default: 0.00)",
    "- bonus_redeemed (numeric, default: 0.00)",
    "- commission_percentage (numeric, default: 0.00)",
    "- create_time (timestamp with time zone, default: CURRENT_TIMESTAMP)",
    "- credit_reference (numeric, default: 0.00)",
    "- currency_factor (numeric, default: 0.00)",
    "- currency_type (integer, default: 0)",
    "- downlevel_balance (numeric, default: 0.00)",
    "- downline_profit (numeric, default: 0.00)",
    "- downline_percentage (numeric, default: 0.00)",
    "- exposure (numeric, default: 0.00)",
    "- exposure_limit (numeric, default: 0.00)",
    "- house_id (bigint)",
    "- label (varchar)",
    "- life_time_profit (numeric, default: 0.00)",
    "- mode (integer)",
    "- my_profit (numeric, default: 0.00)",
    "- non_cashable_amount (numeric, default: 0.00)",
    "- owner_name (varchar)",
    "- parent_id (bigint)",
    "- path (varchar)",
    "- phone_number (varchar)",
    "- profile (bytea)",
    "- registration_channel (integer)",
    "- registration_ip (varchar)",
    "- sports_book (varchar)",
    "- status (integer)",
    "- update_time (timestamp with time zone, default: CURRENT_TIMESTAMP)",
    "- upline_profit (numeric, default: 0.00)",
    "",
    "9. user_profile:",
    "- id (bigint, NOT NULL)",
    "- account_id (bigint)",
    "- alias (varchar)",
    "- create_time (timestamp without time zone)",
    "- credential (bytea)",
    "- house_id (bigint)",
    "- permission (numeric)",
    "- phone_number (varchar)",
    "- profile (bytea)",
    "- role (varchar)",
    "- sports_book (varchar)",
    "- status (integer)",
    "- user_name (varchar)",
    "- campaign_id (varchar)",
    "- permission_set (varchar)",
    "- max_sessions (integer, default: 1)",
    "- qr_code (bytea)",
    "- is_2fa_verified (boolean, default: false)",
    "- is_email_verified (boolean, default: false)",
    "- email_id (varchar)",
    "- kyc_lv1_verified (boolean, default: false)",
    "- kyc_lv2_verified (boolean, default: false)",
    "- kyc_lv3_verified (boolean, default: false)",
    "- kyc_lv4_verified (boolean, default: false)",
    "- permissionset (varchar)",
    "- secret_key (bytea)",
    "- is_2fa_enabled (boolean, default: false)",
    "- payment_category (varchar)",
    "- display_name (varchar)",
    "- stag (varchar)",
    "- secret_credential (bytea)",
    "",
    "10. user_self_exclusion:",
    "- id (bigint, NOT NULL)",
    "- account_id (bigint)",
    "- house_id (bigint)",
    "- alias (varchar)",
    "- exclusion_period (varchar)",
    "- exclusion_type (varchar)",
    "- create_time (timestamp with time zone, default: now())",
    "- update_time (timestamp with time zone, default: now())",
    "- expired_at (timestamp with time zone, default: now())",
    "- is_active (boolean, default: false)",
    "",
    "11. user_stats:",
    "- id (bigint, NOT NULL)",
    "- house_id (bigint)",
    "- sports_book (varchar)",
    "- account_id (bigint)",
    "- username (varchar)",
    "- account_path (varchar)",
    "- affiliate_path (varchar)",
    "- parent_id (bigint)",
    "- role (varchar)",
    "- sign_ups (bigint, default: 0)",
    "- deposits (bigint, default: 0)",
    "- withdrawals (bigint, default: 0)",
    "- deposit_amount (numeric, default: 0)",
    "- withdrawal_amount (numeric, default: 0)",
    "- bonus (numeric, default: 0)",
    "- refund_amount (numeric, default: 0)",
    "- create_time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))",
    "- update_time (timestamp with time zone, default: CURRENT_TIMESTAMP(6))",
    "- version (bigint)",
    "",
    "Key relationships:",
    "- No explicit foreign key constraints were found in the database, but the following columns appear to be used for relationships:",
    "  - account_id: appears in most tables and likely relates to the account table",
    "  - house_id: appears in multiple tables and seems to be a common reference",
    "  - parent_id: appears in account, user_management, and user_stats tables",
    "  - id: primary identifier in all tables (though not explicitly defined as PRIMARY KEY)",
    "",
    "Common join patterns:",
    "- user_profile.account_id = account.id",
    "- user_management.account_id = account.id",
    "- user_activity.account_id = account.id",
    "- user_gambling_limit.account_id = account.id",
    "- user_self_exclusion.account_id = account.id",
    "- user_stats.account_id = account.id",
    "- active_users.account_id = account.id",
    "",
    "[2025-08-23 11:58:58] ADDITIONAL SCHEMA NOTES:",
    "",
    "Table relationships and usage patterns:",
    "",
    "1. Core user identity tables:",
    "   - account: Contains basic account information",
    "   - user_profile: Contains user authentication and profile details",
    "   - user_management: Contains financial and operational user data",
    "",
    "2. Activity tracking:",
    "   - user_activity: Tracks user actions like logins, deposits, orders",
    "   - active_users: Tracks currently active users",
    "   - login_device_stats: Tracks device usage for login",
    "",
    "3. Responsible gambling features:",
    "   - user_gambling_limit: Contains gambling limits set by users",
    "   - user_self_exclusion: Contains self-exclusion periods set by users",
    "",
    "4. Security:",
    "   - user_ip_config: Contains IP whitelisting information",
    "",
    "5. Analytics:",
    "   - user_stats: Contains aggregated user statistics",
    "   - account_domain_event: Contains event data related to accounts",
    "",
    "Common query patterns:",
    "1. User identification:",
    "   - Join account and user_profile tables to get complete user information",
    "   - Example: SELECT a.*, up.* FROM account a JOIN user_profile up ON a.id = up.account_id WHERE up.user_name = 'username'",
    "",
    "2. User activity tracking:",
    "   - Join user_activity with account/user_profile for detailed activity information",
    "   - Example: SELECT ua.*, up.user_name FROM user_activity ua JOIN user_profile up ON ua.account_id = up.account_id",
    "",
    "3. Financial information:",
    "   - Use user_management for balance and financial metrics",
    "   - Example: SELECT um.balance, um.bonus FROM user_management um WHERE um.account_id = 123",
    "",
    "4. Responsible gambling:",
    "   - Join user_gambling_limit or user_self_exclusion with user_profile",
    "   - Example: SELECT ugl.* FROM user_gambling_limit ugl JOIN user_profile up ON ugl.account_id = up.account_id WHERE up.user_name = 'username'",
    "",
    "5. User statistics:",
    "   - Use user_stats for aggregated metrics",
    "   - Example: SELECT us.deposits, us.withdrawals FROM user_stats us WHERE us.account_id = 123",
    "",
    "Important fields for identification:",
    "- account.id: Primary identifier for accounts",
    "- user_profile.user_name: Username for login",
    "- user_profile.email_id: Email address",
    "- account.alias: Alternative identifier in some contexts",
    "- user_profile.phone_number: Contact information",
    "",
    "Status fields:",
    "- account.status: Account status",
    "- user_profile.status: Profile status",
    "- user_profile.is_email_verified: Email verification status",
    "- user_profile.is_2fa_verified: Two-factor authentication status",
    "- user_profile.kyc_lv1_verified through kyc_lv4_verified: KYC verification levels",
    "",
    "[2025-08-23 11:59:10] DATA SAMPLE ANALYSIS:",
    "",
    "To better understand the data patterns, I'll analyze sample data from key tables:",
    "",
    "1. Account statuses:",
    "- Common values in account.status might include: 0 (inactive), 1 (active), 2 (suspended), 3 (closed)",
    "",
    "2. User roles:",
    "- Common values in user_profile.role might include: \"USER\", \"ADMIN\", \"AGENT\", \"SUPERADMIN\"",
    "",
    "3. Currency types:",
    "- user_management.currency_type is likely an integer code mapping to specific currencies",
    "",
    "4. Registration channels:",
    "- account.registration_channel might represent different signup methods (web, mobile app, affiliate link)",
    "",
    "5. Gambling limit types:",
    "- user_gambling_limit.limit_type might include: \"DEPOSIT\", \"WAGER\", \"LOSS\", \"TIME\"",
    "- user_gambling_limit.limit_period might include: \"DAILY\", \"WEEKLY\", \"MONTHLY\"",
    "",
    "6. Self-exclusion periods:",
    "- user_self_exclusion.exclusion_period might include time periods like \"1_WEEK\", \"1_MONTH\", \"6_MONTHS\", \"PERMANENT\"",
    "",
    "7. Device types:",
    "- login_device_stats.device_type might include: \"MOBILE\", \"DESKTOP\", \"TABLET\"",
    "",
    "8. KYC verification levels:",
    "- user_profile contains boolean flags for different KYC levels, likely representing increasing verification requirements",
    "",
    "9. User identification across tables:",
    "- Primary join key is account_id which links most tables",
    "- Some tables may use username or alias as alternative identifiers",
    "",
    "10. Time-based analysis patterns:",
    "- user_activity contains last_login_time, last_deposit_time, last_order_time for recency analysis",
    "- user_stats contains aggregated metrics that may be used for user segmentation",
    "",
    "11. Security features:",
    "- user_profile.is_2fa_enabled and is_2fa_verified indicate 2FA status",
    "- user_ip_config.white_listed_ips contains allowed IP addresses for security",
    "",
    "12. Payment categorization:",
    "- user_profile.payment_category might classify users by payment behavior or risk level"
  ]
}