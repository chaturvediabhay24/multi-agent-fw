{
  "class": "CustomAgent",
  "description": "Focuses on affiliate relationships, campaigns, and commissions. This agent can answer questions about affiliate performance, commission structures, and campaign effectiveness. Tables: affiliate, affiliate_account, affiliate_campaign, affiliate_comm_history, affiliate_entry, affiliate_policy, campaign_entry, commission_ledger, comm_entry_entity, user_commission_history",
  "model_type": "bedrock",
  "model_name": "anthropic.claude-3-7-sonnet-20250219-v1:0",
  "system_prompt": [
    "You are AffiliateAgent, a specialized database agent focused on affiliate relationships and commissions.",
    "",
    "Your expertise covers these tables: affiliate, affiliate_account, affiliate_campaign, affiliate_comm_history,",
    "affiliate_entry, affiliate_policy, campaign_entry, commission_ledger, comm_entry_entity, user_commission_history.",
    "",
    "Additional Instructions:",
    "- When a user request requires multiple tool executions (e.g., multiple independent queries or lookups),",
    "  dispatch these tool calls in parallel whenever possible to minimize response time",
    "- Aggregate and summarize the results from all parallel tool calls before responding to the user",
    "- If any tool call fails, report the error clearly but still return results from successful tool calls",
    "- Only execute tool calls in parallel if they are independent and do not depend on each other's results",
    "",
    "Instructions:",
    "- Only query the tables within your domain of expertise",
    "- Only allow and execute read-only queries (e.g., SELECT). Do NOT allow or execute any queries that",
    "  edit, delete, or modify the database (such as UPDATE, DELETE, INSERT, ALTER, DROP, etc.)",
    "- Never fetch or return the entire database or very large datasets in a single response.",
    "  If a query could return a large amount of data, use intelligent pagination and inform the user",
    "  about the data size and how to request more if needed",
    "- Always prioritize concise, relevant answers. Summarize or aggregate results when possible",
    "  to avoid context overflow",
    "- If a user requests a restricted action (edit, delete, modify), politely refuse and explain",
    "  that only read-only access is permitted",
    "- When answering, provide clear explanations in natural language. Do NOT show SQL queries",
    "  unless the user explicitly asks for them (e.g., 'show SQL' or 'give me the query')",
    "- Do not ask users for query confirmation. Always infer the required details and generate",
    "  the answer directly",
    "- Provide answers in clear, natural language unless the user explicitly requests otherwise",
    "- Focus on affiliate performance, commission structures, and campaign effectiveness"
  ],
  "tools": [
    "postgres_query",
    "append_memory"
  ],
  "parallel_tools": true,
  "max_parallel_tools": 3,
  "memory": "[2025-08-23 12:50:53] DATABASE SCHEMA INFORMATION:\n\n1. affiliate table:\n- Key columns: id (likely primary key), account_id, parent_id, house_id, user_affiliate_id\n- Contains affiliate performance metrics: sign_ups, first_deposits, first_deposits_amount, re_deposits, re_deposit_amount, total_deposits, total_deposit_amount\n- Financial metrics: commission, wagered_commission, classic_commission, placed_stake, returns, pl\n- Tracking fields: create_time, update_time, start_date, end_date\n- Identifiers: username, sports_book, account_path, affiliate_path, role\n\n2. affiliate_account table:\n- Key columns: id (likely primary key), account_id, parent_id, house_id, user_affiliate_id\n- Financial data: commission_percentage, total_commission\n- Performance metrics: life_time_sign_ups, life_time_first_deposits, life_time_ftd_amount, total_deposits, total_deposit_amount\n- Configuration: commission_cycle, settlement_cycle, user_creation_enabled\n- Identifiers: user_name, sports_book, account_path, affiliate_path, role, currency_type\n\n3. affiliate_campaign table:\n- Key columns: id (likely primary key), account_id, affiliate_id, parent_id, house_id, user_affiliate_id\n- Campaign identifiers: campaign_id, campaign_name\n- Financial data: commission_percentage, total_commission, available_commission\n- Performance metrics: life_time_sign_ups, life_time_first_deposits, life_time_ftd_amount, total_deposits, total_deposit_amount, total_wagered_amount\n- Tracking fields: update_time\n\n4. affiliate_comm_history table:\n- Key columns: id (likely primary key), account_id, parent_id, house_id, user_affiliate_id\n- Commission changes: old_percentage, current_percentage\n- Configuration: commission_cycle, settlement_cycle\n- Tracking fields: create_time, update_time, start_date, end_date\n- Identifiers: user_name, sports_book, account_path, affiliate_path, role\n\n5. affiliate_entry table:\n- Key columns: id (likely primary key), account_id, parent_id, house_id\n- Commission data: comm_percentage, commission, ftd_commission, commission_transferred\n- Performance metrics: sign_ups, first_deposits, first_deposits_amount, comm_eligible_first_deposits, comm_eligible_first_deposits_amount, total_deposits, total_deposit_amount\n- Financial metrics: placed_stake, returns, pl, total_withdrawals, total_withdrawal_amount\n- Tracking fields: create_time, update_time, start_date, end_date, comm_interval\n- Identifiers: username, sports_book, account_path, affiliate_path, role\n\n6. affiliate_policy table:\n- Key columns: id (likely primary key), account_id, affiliate_id\n- Policy configuration: commission_percentage, affiliate_tier, is_active, is_alive, rule_settings\n- Tracking fields: create_time, update_time, start_date, end_date\n- Identifiers: affiliate_path\n\n7. campaign_entry table:\n- Key columns: id (likely primary key), account_id, affiliate_id, parent_id, house_id, user_affiliate_id\n- Campaign identifiers: campaign_id, campaign_name\n- Performance metrics: sign_ups, first_deposits, first_deposits_amount, re_deposits, re_deposit_amount, total_deposits, total_deposit_amount, comm_eligible_first_deposits, comm_eligible_first_deposits_amount\n- Financial metrics: ftd_commission, wagered_commission, classic_commission, pl, total_withdrawals, total_withdrawal_amount, total_wagered_amount\n- Tracking fields: create_time, update_time, start_date, end_date, version\n- Identifiers: user_name, sports_book, account_path, affiliate_path, role\n\n8. commission_ledger table:\n- Key columns: id (likely primary key), account_id, parent_id, house_id\n- Commission data: commission, commission_percentage, commission_method, commission_type\n- Event information: event_id, event_name, event_date, market_id, market_name, market_type, sport_id, competition_id, competition_name, provider_id\n- Financial metrics: total_pl\n- Other fields: owner_name, status, create_time\n\n9. comm_entry_entity table:\n- Key columns: id (likely primary key), account_id, parent_id, house_id\n- Commission data: comm_percentage, commission, commission_interval\n- Financial metrics: placed_stake, returns, pl, total_deposits, total_deposit_amount, total_withdrawals, total_withdrawal_amount\n- Tracking fields: create_time, update_time, start_date, end_date, version\n- Identifiers: username, sports_book, account_path, role\n\n10. user_commission_history table:\n- Key columns: id (likely primary key), account_id, house_id\n- Commission changes: old_percentage, current_percentage\n- Tracking fields: update_time\n- Identifiers: account_path\n\nRELATIONSHIPS (based on common column names):\n- The 'id' column appears in all tables and likely serves as the primary key\n- 'account_id' appears in most tables and likely links affiliates to their accounts\n- 'parent_id' suggests hierarchical relationships between affiliates\n- 'house_id' appears in most tables and likely identifies the operator/platform\n- 'user_affiliate_id' appears in several tables and may link to user accounts\n- 'affiliate_id' in affiliate_campaign, affiliate_policy, and campaign_entry likely references the affiliate table\n- 'account_path' and 'affiliate_path' appear in multiple tables and likely represent hierarchical paths\n- 'campaign_id' links affiliate_campaign and campaign_entry tables\n\nCommon metrics across tables:\n- Sign-ups: Number of new users registered\n- First deposits (FTD): Number and amount of first-time deposits\n- Re-deposits: Number and amount of subsequent deposits\n- Total deposits: Overall deposit counts and amounts\n- Commission: Various commission calculations (classic, wagered, etc.)\n- Placed stake: Amount wagered\n- Returns: Amount returned to players\n- PL: Profit/Loss\n- Withdrawals: Number and amount of withdrawals\n\nThe database appears to track affiliate performance, commission calculations, and campaign effectiveness with detailed metrics at various levels (affiliate, account, campaign)."
}